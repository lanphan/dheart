package core

import (
	"encoding/json"

	"github.com/sisu-network/dheart/core/config"
	"github.com/sisu-network/dheart/db"
	"github.com/sisu-network/lib/log"
	"github.com/sisu-network/tss-lib/ecdsa/keygen"
)

var (
	// Copied from preparams json file in tests.
	Preparams = []string{
		`{"PaillierSK":{"N":20988117346843663540335999488355070160621886330217414468672501921179281959291022109699786369406738335531294904510372150802611489881785511720638219911485067606999627160999932173537005518747217502294724533070183008760669397215597253846363322011196387959379735453967402218176844542414741061455149491445006472285609303012686675007054532002025516875447919478432602334867844785345937688045577763338914491525961334192270523432214720153625940251024728697927873007066404974333074679209518020768078516642466544255058986986701922924741446303226698221707121384796841555588650070559403680995012588851100916728687595121142162539109,"LambdaN":10494058673421831770167999744177535080310943165108707234336250960589640979645511054849893184703369167765647452255186075401305744940892755860319109955742533803499813580499966086768502759373608751147362266535091504380334698607798626923181661005598193979689867726983701109088422271207370530727574745722503236142659639515838884670291799887677045800614388183817797554337097130041565339371242571196305884772252720200882835826286665716756193500614615212976974563037333608239566282095148016284067421289031735365393118147021639804679542150844663320102167954006919861714586379551994752268023408633819213331827060145750717418102,"PhiN":20988117346843663540335999488355070160621886330217414468672501921179281959291022109699786369406738335531294904510372150802611489881785511720638219911485067606999627160999932173537005518747217502294724533070183008760669397215597253846363322011196387959379735453967402218176844542414741061455149491445006472285319279031677769340583599775354091601228776367635595108674194260083130678742485142392611769544505440401765671652573331433512387001229230425953949126074667216479132564190296032568134842578063470730786236294043279609359084301689326640204335908013839723429172759103989504536046817267638426663654120291501434836204},"NTildei":27950798570900670100876657260420279684182809159891299582705232572844329436935189572111728932907085583844690124133309669468190777488041467703525270137194300774105375984643880184462445630042729310023358890125370012523296472767647783834954922215896365368185317697696215676088009118505547374212932889392164249631533804408802685204292449065793940787655189249965203753684260113513747629562133684257700790260199440152870018715909013039628251690248096112337313398892682924274229130263125424269766493019971395597809001456812095788119831527110907873076581949769743579251568542376750655361633976323454828145607778643233690250333,"H1i":15893700092939815334537200348779413831710206865368026617714396801730093121302914435016457173347901449456145873088625420074599140125366863022960515244462145211262448421818152149635468832203569872911125787456729838819504658240319158483617909033810660393745214182700624048246456076308339982489448757161256666587859575211805613322258134874270416542362105944679138698731475932283298810713372205325960779908360934179345966358117588120695948168582283456310096527421895388591863915800996814057705244589233267938433842143104116234106387016116499551382142358010547457945682986520704790386371016314579591597970321563141182317475,"H2i":16986592873315225583542593599635566858359220577191836317214090517468378521709870478124283223576541018396039101678102068708430816956478208590515738821719102112331365953165735950556681252611387583068686780796930976196300457379853342697512406453436109153064211096858791835572193045082565230087756465235744709262817050438884547221890510672528952807945653186157871318324042823464638037430847738319640728304776017716197117107505346679541362236605769456513479875260752920623533576634483664194016078486099068172162727916286058898037812180958231599030448673615305950960333219012170989763832179150906423344139863867318383016211,"Alpha":24593777022677937033591418852021928259599693637185198263156515716306496408936566539451357876569121264617013737143477962787744906112547358378812278453435469237000887212574079451290168975419833882485798554171221931439344304385135125680419426700704480247461587367757741232463530479573450606121747517035008793595913375212730636173165716400641092151744820346631988442475114894242791818605364163257867111256314241075389606138425343681343299964124815307736254332842496999235938192626408812749583851476057887723536346033855035416626209409280967222478924769059464238566821318126599638656726631336844435250346939368105716893680,"Beta":4368222230107634753065835342996439675892667939126383239808477134369688672597975471162751425938429054566337658591356079188424391504726684553115599158743599771275537830458031038542021892452207381407049670641606635751315679767403671424322580187511357965363976002556052569659040056484554931176002660591922499443707197984075052628835915460963888896602639409503192654864534828840747819945566741886638518805353243936298054962565011878991095278300550983513726669480189093964703848074617473042188669326948367171913092753469270847251325307394763116864276494510176553129766913842946162207129131699632451789404200341453505060628,"P":87274755247470833693395305473786245834213832863104472523568981198048176534061537936064944007781979926804953962769511183529813029283941784651100924178741355741760293362386807702687280248931274242843550211776032744852305044056820011918548339499266554556464468086180530533802435320737043539126562223721908503743,"Q":80065531239947723246713380916886192595904255982884443281038796500920960589292151989205613500973975283948635189147940042260262820322176450778210447629434749973789952681447095686614620570633635658600091854626530068799307677338171985383559316741994784580941196129693287009819461320936858698754242814907303718929}`,
		`{"PaillierSK":{"N":23480897859705367187360013655993002874696507573399090370367450600741674143612782815231368701976721918220624096153394674399965180369717021624161950203435380564000790363090629447493193786420968214111997892021744965629859603164611502558970107643962845211496101002783917945105602018719068763680547011703564524107693548186023252849089663729522833751374999990660396858342462388043074195138209203326680579450944482483773314657058392707099394374453496964938112446033521050487059183053467089278564065644440528653455875465666851016727443855600662388149047412847554234085521054397952009749548485638168458774713079219449410704493,"LambdaN":11740448929852683593680006827996501437348253786699545185183725300370837071806391407615684350988360959110312048076697337199982590184858510812080975101717690282000395181545314723746596893210484107055998946010872482814929801582305751279485053821981422605748050501391958972552801009359534381840273505851782262053693297680036611552596774640843647557964483816729674262821405290195345478525364515261126304788824795136844475492169651925493618420380867833030442978557248150116332943328256734097604576022292794395919291897527244012161524093627484664688463214700820786744669750684763324028917782566741425964233589394183940712014,"PhiN":23480897859705367187360013655993002874696507573399090370367450600741674143612782815231368701976721918220624096153394674399965180369717021624161950203435380564000790363090629447493193786420968214111997892021744965629859603164611502558970107643962845211496101002783917945105602018719068763680547011703564524107386595360073223105193549281687295115928967633459348525642810580390690957050729030522252609577649590273688950984339303850987236840761735666060885957114496300232665886656513468195209152044585588791838583795054488024323048187254969329376926429401641573489339501369526648057835565133482851928467178788367881424028},"NTildei":29671683534577314336172209528062719894010653861179051883720666531492499892227130554343600604137979639038102476575570384106688730952384617155299207873743717295834669038468880200020944789536315026714132993483006395109421359649084021008922517295513181775626364309159535732165899289912203795784307618069052200116570026698032447804112580061051509936886912405312730009870735616001112858422961361250682749830791427132204824102118535635960148900360229176146057885664508883175958249803376403020489092772682214817246148718275074950915759623258643456654996366503201790918593002520799243415417226065148636195421867364334004999577,"H1i":15569075867951770905405721346447505985985163058597239465309659932644035788559452608592143277149389706638019446573554199325042044739180453666196212111903939804327103055906008860160916383752614404384697405820628511553568086163444930533399807856779563189243397213719691818614645945827968739148690959164962568320984492621197381157591660969468480128564227450827022127298869803308210495108325130809262768044296810574093452862609413677949254831386376003136680629790605776510601900004422221265065318891536399240084054957056335351021185224153873059767638113980662453668438825058415129452389526754849408520507414119793010303016,"H2i":28891411290420294643092837042879593533269307598380674556230101674586606350021058884988680839066534170674851623402157644107784167096501271513592475506730994333127423639426689541398857003086673280874515278983051152230082159387722008179103950620737056036034137237204413705931595112392211175067605567285233428640641974650218596869168450866432507805474787192694462069715267785746320190632093082395413251419433810749728831599955466326136972794104593356976142467209596384046264188766151810952641393940376691686902132843267492490545296057362667554853119447528134954238196844910689810261458744012601024762236409764799914566640,"Alpha":17002543138575204312886890597857967301883306130121280336768657414227669866972297344434341074574195542055397075480538695438925722699736703412973470407678865646678157035624604319006694794211104020147316216986968570776431231561539479796494067713738260344543386791951639941583666547114225082399892500388715584838047523460492030932257139403727845857782871779633685766997263467790592949920306998785291436367559357965372766713184838740266134794475258843007262817310246029994607016898477209221460694881737930996338485262689671403333776754402299219837807217858974108044535985972392420929223920659897208769858425008792017917367,"Beta":5367307206163126004722262007783721973015265042950101412191361136612964343816772786998588544000958221787378291669910894498605792898157204120698568445625173334951619349162918565764986649207622219169951590801487768486403126244578599153493395080993281303881759996724491041232552093856403125350889907883393631568257602220442899935207633919283107171542047460787948689334954498083229525912697033118686898838039786052666542730958721413657374916958905297314002730683114900263865766668069077394951071645154370545063011145580089199176447699061329363029952812523381087832407435277023980313969227935584812319596778067862071517348,"P":84994444045517213683586775183880722791489964486177918796197052542620115156462018975584025620058379264777800830459289735101747820346781529106537624981058637310122274667992905043121978710672317410995907289222027527099814649792865567085601713193488168789125600636563086226550699342671230304422527607670882632611,"Q":87275362136280311173911121471201839164339601211126101834909246302803659166585994354221490239063280039443577510721566699584258156697941227950709409286302484323412651327080755858295472130298068740253673997554865423482563702655858399031280143865655119196520874658823610549741374586882007787480955646710175798799}`,
		`{"PaillierSK":{"N":25274398240743045422112559229367505480739743155884840986730902979959066853227661201136710565978717584863321090027839449890985456723569276763022725784089832505107831643285936549491820132707343411571017506192088408990095159522782861626021191080596928579214742953716369051456349743069668519478142444853721238510742845622490897284964202612469365964287891925079488137286715889771993223857887327960267298250360753391209898993734170017043326062693924319147311068463418699912071999368351282263583930857685784111296688879581731653806925365976853024906847983153969626464696866101803233611075426805356743598007545006751497232761,"LambdaN":12637199120371522711056279614683752740369871577942420493365451489979533426613830600568355282989358792431660545013919724945492728361784638381511362892044916252553915821642968274745910066353671705785508753096044204495047579761391430813010595540298464289607371476858184525728174871534834259739071222426860619255212302649325717469851039505123959370366094662183480766473021502963927219868347338883566881725050025950382015453601526711790369691576149471268327505604219920796041598504553546828495627302335092205943352546482742643048648734444320714450631404125749622532100725914880682337386332035285764490267789747386094601786,"PhiN":25274398240743045422112559229367505480739743155884840986730902979959066853227661201136710565978717584863321090027839449890985456723569276763022725784089832505107831643285936549491820132707343411571017506192088408990095159522782861626021191080596928579214742953716369051456349743069668519478142444853721238510424605298651434939702079010247918740732189324366961532946043005927854439736694677767133763450100051900764030907203053423580739383152298942536655011208439841592083197009107093656991254604670184411886705092965485286097297468888641428901262808251499245064201451829761364674772664070571528980535579494772189203572},"NTildei":22363432448309193969617418936932738288554657083414867460905983656978698043176762697149769464100156724259353274171953643646393302545496216389737260876832937027220712119082665698234591116427441191103362112960717296570372928814357569970206983562348319936144245813449116959840806301166027598595167609089286900610866055775894732699096447858378419299354701511919244711790197375154190309547705329831342062567870459563670608917145826941163617741584397343935255829155547021550210402311076490105800254898611196319316278997456045357274523587970050683807249832636736407025898402465481943147938550077034314941251153974183942869717,"H1i":9452821592227412557076575107771791437704770236145708570118680771482324739861881486718173924664240186284900841697816732803784206589170248508059848870549970003698844152106084352601991999436266739497830736926686659392619391865698614331453091437021215779947943723502729797615095643755590970681699150387318531543568182656719779863228192968782422923780413022721807945668038418576602004310959446662337330720519701348052916914793785228106055035480242306107456193445552071765893133000547670233950638691773033811070295854554457693104559653005841993397004593803066264116115104505541263457708169828585244176827022889324553904924,"H2i":11640691393488789533882521712155359426948743372390753814539722408994704009031004003732699082225884866048604656612512418244992451866456774671539342234927757864636912049995499773942949276341173755814658826330799060841051179183871140638760564613886257866710966033542193335523988319761438115571064409503476260064907215381834471539329014819746572282378853089028305661764248716073603845568586835260524179213625975150407108106503546102679615306727066129969205602303709004739908473010062501895710498750671079609206246466781606843936302069140618694524095813904753390391400469783834523506679823707469297209883136750365783118994,"Alpha":11531884857363412413954022979949233421909722056273091450307291197386062717445880647935677118719424788220968213979986283038050665815245836308078238515419207139545534612053903747393769886711807790889961400464559519500865149758578937779070743506255298839971005867595034943598064023374730798998155844537555912242070179338376441609783474796405793028494253478826675952983439267707107928280693812875719793531590898602750144996141153586643115757142475788296611695506736664492337402130599094772902872654642461136070613019811773435900771775332500505338320828328532649877305079664652533050710544347812986160884288999055866888056,"Beta":789322251468231588765644617786461252593237623096109768427715584016807168172934391801049917913794702386459624818482288666318143398220739660752435920501636511140419182664642641487032617333354781566876586625952121274941824668069961401956516382564355210460527831263156734312855806831696326320713558265609523265269951818985681148325615489543121750352159461073529266869562768425256936083989268968312219690729250294772586562734556675498167509439148593076180253930085993360580772892887500555559093925356018123917271862718609478262800606212111188988428117092495021523007204213740377996318891819901562687921020681149890727998,"P":78461818142238657850652993075668505948183480205507684387881843351980224847698008796905057249683105624142067288142381495592985021976460518393055474150174428885068222073256964406550936192409643616096089051851601357325647903514441484583672093140616631881768572089537951763575477825063287827386562855987712853111,"Q":71255780766410126669379549970283989258554796692466505925464544927466364316112786006916134328181876794900150256770761437479936451946932879264137032313898008421381640860894591019606130031191539585988030522174439479451881184016488417563942132276982476984096137999806502073709699610553867400368383759431691107389}`,
		`{"PaillierSK":{"N":24423193199528760057917437429488784720355677692029929828350854657115841272576565086049920492411622802556331083973455519301845273024183566780586370252084074728617597072501303958915876886186506082838833935678625621370426536038762452244702438212796595274636626781893770960591711313965991206022742840071196705931007495172296219306200325570133462572917166068832581360024478423480874411806584964894064806175248978638849971411001340452501420451309786035211000399233655106276594862302333984644316257463957808424501669620282458120132300918081032275059245079120836685469163023225761298759863022324707997682188908043638894373437,"LambdaN":12211596599764380028958718714744392360177838846014964914175427328557920636288282543024960246205811401278165541986727759650922636512091783390293185126042037364308798536250651979457938443093253041419416967839312810685213268019381226122351219106398297637318313390946885480295855656982995603011371420035598352965347098791336397006818349370934554314637541929945651422321000695390333421538621978210204922224558916432803655631988800909265523959846731496011476150800980272687910981228496257991146168554023795267385657644946113601269781012499685704842601427488028636271785369927612692261284090190943645573371051058403305594958,"PhiN":24423193199528760057917437429488784720355677692029929828350854657115841272576565086049920492411622802556331083973455519301845273024183566780586370252084074728617597072501303958915876886186506082838833935678625621370426536038762452244702438212796595274636626781893770960591711313965991206022742840071196705930694197582672794013636698741869108629275083859891302844642001390780666843077243956420409844449117832865607311263977601818531047919693462992022952301601960545375821962456992515982292337108047590534771315289892227202539562024999371409685202854976057272543570739855225384522568180381887291146742102116806611189916},"NTildei":26663829634261358932439480929292032403383629822009463344170400917936867258108731483187552056139006115208365744371234360602926483765315994880237079399098287277918086726804644581326959898431928732940729086870501014364482094288617374846921675512622954331374466015802114381412883461019887371921041062452408366269750330216728247232268165563650451805481009881288525376577727955842016906229348813338678923462818451833957808842968528522537046357107955841350572947615152021713520918305630737178920775354339106680983096577932336904584861222751867277033030354089808879334169647656729131505523686183639821446638915750575958024153,"H1i":13636881780418929593673223057988979756396047230085184893768487688696032310556853815965188742397106911002326673406073795459218558492959052137079766761929422340763787163476826772596942821203571048587946723821321690453007476575549539181703242238921178170404071232945825187890575315857483192978575960064721090919020386259819620804570457752889582705610654639297618808739410657616267246433881883297197631197292727437190864954746426290183470555343101386679149575516284297581726911944595396798831958418808183080496768997498687100362268105131926303607352245992783018803948259095316613023357721818686328474623029461728150081870,"H2i":22382474404783131074874895496065243714059095639491950557883879033866681560544003801854356794324952362992847122358406076427416072468068211435879471422468155736802174304216780177064114636545894734742059952082240695954445028746475766985337380610497614496174734864999267616881853946069265809865950174736089814063928182029958954270211910450724831686798178840742368444300288090794680103368405954159965570346571663058625831046209657053599414824624870583662487603183005849933560257730074826245597787251861537865223140826149473303936446206689812635919103767372028258273842200548903184739407401545405191777067514653454086470913,"Alpha":24989214328250976930093177263417665420535146055733865928475975685513180121941645932360252280466455932776423998414720495927442839501026068833857415500424933235630142089470364466727679375825362424051710842655183944061631539321752326549354682438669746529561869624667749673920541190112600049448465969347203456088290555619539821447079255348572738502572531101577945097411707644371988159659808510878375553948507869607526112503982164638054112914023984309314442828479129967948374924216770058343388212981710730788230137757943190085815671936691387399781940433784564585622337233490733196231337041548485866089512924089842993768080,"Beta":182267900385210479877185343324328631268419235676254908430894109489589043598564605095555309608691924037654518807262324791859837258349658820147918258062856907831064850301008618729912196912155300307514950497093956846740858015761466195386525620110013339764827431353777329343290044249600231925933725226373755428290018970456371431953592604621210956282320890060655384292875298348162510673353774297996725769118244622565912870662335671601711194021308094998910810358525879476602841892486729168270473767072581226495186857635208900058065206275039711258938040277198599187899186069917118494477599580606693089780599949553528636698,"P":86280559339831377917178424318877021730887860289888963121228641458530026775393283605277642751254657039259395337151399417425009005343009534206866104306553759457690194734188588374234938765036407229368679556322407025843478848689683035667170835744578315738993657746070371039121762973736867319495817530533562149119,"Q":77259088948534479002431435740006369205036622793381517758721367673199303248160427666471856391963725757606573772925688218695645630106108390223090156949113367994755262444790775897662527907370118248220185291169319394887640058139081063377353703329035898570323621473008097791186093190451693868458245283666843750163}`,
		`{"PaillierSK":{"N":28303161378500688580771071132040469477640323927242518222709841116636070050192717023468842180873067762151142635727713639400846615213093310762810390811028310662618372162397170430793901014599708480766499742583856356853745401015924112125146700526203889332979208013520421072303953731663935591378718199897015882557564355135592305080490533979265212122388531987032326793424506533488716307417573385623357243694747993609963844680362652339348303095422332697996706080906393172783673239703816349792488788857554487609944787806208707227492486555169999743754274521572427180253003091570423590711635158932674920186389072277637746332281,"LambdaN":14151580689250344290385535566020234738820161963621259111354920558318035025096358511734421090436533881075571317863856819700423307606546655381405195405514155331309186081198585215396950507299854240383249871291928178426872700507962056062573350263101944666489604006760210536151976865831967795689359099948507941278613704422562083037625188250873432327791837420761332102273779411422356365678073824467517213619429918473028031059661276684868812042049715586184517288270530030461333808133928593112372130884508276686275562632447879806926470190561577501538360650854898113967208096660272401415484040146906352754315823848232895544786,"PhiN":28303161378500688580771071132040469477640323927242518222709841116636070050192717023468842180873067762151142635727713639400846615213093310762810390811028310662618372162397170430793901014599708480766499742583856356853745401015924112125146700526203889332979208013520421072303953731663935591378718199897015882557227408845124166075250376501746864655583674841522664204547558822844712731356147648935034427238859836946056062119322553369737624084099431172369034576541060060922667616267857186224744261769016553372551125264895759613852940381123155003076721301709796227934416193320544802830968080293812705508631647696465791089572},"NTildei":31094621445721472427589580097089504039117057621785050089123759596359963437197818532549727549393095998699573291040663489552983337297327824017579883152898691268157629478300602057274530610825449877712035680217818531878269992629301160639181347117481167782562745276697595763275542410770075687210355928171727822296747967058866751522321913532366264304297628692865991245057367630131931925920922867066620016172991540595602858386714146566017644368578912438487077031180497689230427800816376014861934576780656283484713081384150090758122117306150508757025818483516903905567573594642571719558808462650883931127070292387503833316033,"H1i":27909996892356044581664191224263145410034026224328721096482472653821933802658277209832882789348860218292258566797760041451082206784355946530828447440307019850858848924402646373125522687130240769832433428918147414416480355722573984197602526460787304067056548493939258609075155295492702349824564703513134020162942789908899536928803760148079329969753005582872092364847858282337443016024350798080403374624275509268218804050472742062267836586175054694177780256792434898226427140961278294844532183384025135082737646957720314924095597029366726958781076968900241068601367810089527451860334276915077909509903764396571758472753,"H2i":21218131472736092859957443292093205095858586022849683940343225148399984429007911303359919903511197092400175547068612036898002435896719378659623332296809176679086159915584243503500220180970298257892979204479318116543118646736819357043538632967180551538548566233595186410453600041113298272051644909221922491268656767818614801954801281876781211623859462860680075568248395592792970419195998570513452706625302444720008209197087651313184585458459960052731797813158213610689824178048777207447927814721054428504046747483945804054221243156440211832986417854025966249228185222218801050168784552220682887660953616691593041348187,"Alpha":4054157869066940029943870427536850888284929382018772920689875716454810905391485641395587294416079007161143989118082018476357158013227496561919716871870934331324171519151722653396530671552017288011197000386154793640233436410435069726379695189356098548744525607764712650045152343076810956943105815849868259068163708100092140331637315232461528330797594340819391724332714446654066986707968593855138609602851290869904171655352003106306655716938263110042709318542467449059119027319174490872505102058552074174870747773289164124993677840250634403949523513269448880081760609675106789947475736401112951332644202421312343945901,"Beta":6932065302848363908548095257402493220675044795281980694729314602632208515588835235417859380531715198290799882273538086231044307904656547320218296665764338234672982262130620177893075258670390034411060972515384498420658834669071363822637504477191399938574730963691678041078535385508507535232308644244983862090746613014164276428726745288786246936509409147055151815844610495936783444470417560111256871728486423292574660920774562430899256222221788306767428958826210871503732479073816678099474026372738810670621785954194339819428556395088738025000351852687649765662013366175074287773755695389117707351873683800698053125281,"P":86649137972855354753649650968004083656252935610058821998584438114087379072412812891363259876466209486488526802001123616312916271538023740355613987096271804611130359055063516620749175175654392728069416742779866896290959369357750454762229052151160425483578581933598874518018175895625677829233614891958847179789,"Q":89714168464845286556075514821511969985733465994931461399772848735311444757321854327042180996126127339980705273486281126531337283453595757260533734882237356913096695451299317514597488131248904085790755946683811742799532434371614965784484182684419565549542666338858117265424406520442398305898989283206523670313}`,
		`{"PaillierSK":{"N":26371052882922431871555724901122237069089182372653952889197603509193310961332998886282836819769779026843087148651765306153335142159769209717983381742243107269768157561534854683357455031800823369776831752104529149081920361725806293157446194309156093634649860570312804884220968263418791084216945853231585632467128386606672741191791564656358134221461239997458114765932155352839104534858257555985373349072904039971748137606895675623109665119476971779699573274697187985528887837762096360111715239715493418568013013157841849210694733343800943399239385371121638324004061651060193425156781791562426371799246719393689758944261,"LambdaN":13185526441461215935777862450561118534544591186326976444598801754596655480666499443141418409884889513421543574325882653076667571079884604858991690871121553634884078780767427341678727515900411684888415876052264574540960180862903146578723097154578046817324930285156402442110484131709395542108472926615792816233401444752882198517493653124781881958305806282441604220707814642841867810076338750975960595783076582494604730858444706305707683403386528100990220706177381000457994862848373104835895284878219819500621996193364813367901418349153165607245018890942562167308705952262418358408377480325836427411581150005209135690486,"PhiN":26371052882922431871555724901122237069089182372653952889197603509193310961332998886282836819769779026843087148651765306153335142159769209717983381742243107269768157561534854683357455031800823369776831752104529149081920361725806293157446194309156093634649860570312804884220968263418791084216945853231585632466802889505764397034987306249563763916611612564883208441415629285683735620152677501951921191566153164989209461716889412611415366806773056201980441412354762000915989725696746209671790569756439639001243992386729626735802836698306331214490037781885124334617411904524836716816754960651672854823162300010418271380972},"NTildei":26456086681264577014174567473479326612118813431297142171335901944384754358520089897751319436700571117018060213750085449016432930864325934397335846804269059129954824157653842978809176731781137433310558493984094046646021833680236630412640117294878076396025749303853071743440436612046000048625591683152542689220659442796789023359782096207843639373796228976646653112700652918722063873644289586964515639608071892775986686674520451380863166590006407555801166515919254070053080348627864507742389014150222825219774335766992698342360632169384884236337399641775170943598415355434184443249465161827329074650685626499014757576721,"H1i":24118267881104861573162005547398744759492124424522066551078577218843455745996429464908441650204823643103623292130976010207699127292170972522196922168908892952444721738965279108044276758693775710787268030117915918352362560135707343789931596273763449365531822146649834753772116978160078139393032646786306990928835579503133668071615978171878471829254052877539814122935599452420139044051058185397916143990275507345539697974368940856502028126403370206205765706588168751016940571271353418044571053723473982163246306121935389732324971175826663616408435083432738074710678357701366999393193833440483257776368317949521143685106,"H2i":7543703636590899434970661082995019960255507504818079302155715187591897270522295371458414764756228735799570063390807694418020867366390494938664041004179030805126253204349218531277701147390738688865025520229413523610450213913924220016976948714185580831609584918850548894290616932186251969313937371697149673741065843376147506494856002876666187839037701633197743387818000798793812969261954164092084896831058751763225627962992977801095351203357429035231256876259320168512885083227465252640777676880796394539413730133545197075692827517411270588670527323706579818236363540093691388931158358254488134094833292506010737674612,"Alpha":13163593692028715282712778189905019349991841415717165444615530721362293231270701613232632161764035301111522133826212513891598620374635333592390820448589400161309732868125200520316198228187866207847406035950504075848455142399886982782074703537322942879990490680112602099022109198590321431602446792573976243651175617436805593812648363188492204223471032180339552000441888206333979703305498747842765439544006591416554876022353739460557700537594582365705010353896713901109754435260138712712946346132728828341297718016857840254375706879916860576021241056233851276182504440945036171111914075436545140649824138497778486166854,"Beta":1579784346283267787195155950387801068495147842260778745818705132626321281241304186707854153807894837089784722365504088517032555619997060427984990528544242930664850917347856134283492132064141233310524531331008952378289532099721263645103678496073724637597434187276515521907376232472687727142379513611958462868502095372203045597170166798729310657031769651331464050732674305817401474682274046345440942252555894694624466578174317072668217366514416685993305991600137867851775428142702773259641680408505453727074809151413607465330566472285014138492627616211873654816796639699627780020825084381567777915621636133117805147348,"P":89764873995987706449888931738863164559050943690564252631590957121090222420352993695304452035003475812481517169987106159234042396503642062885343210364776013609965619099700590564802634125448410354932459549073669725720505693390395011846055893829821430321677450544923916745103433958781680703568780363714822132589,"Q":73681623734154370419033842272561125026623611125542203580146884161357010391674925587272092133798456751402809604461543490557820570133773559437996445631960896034281241728028558886449916742471819349855501863709310470868655799075379996054095994539464069317418229638313303389645792032379355488127886423547250378049}`,
	}
)

func preloadPreparams(db db.Database, cfg config.HeartConfig) {
	chains := []string{"eth", "sisu-eth"}

	for i, chain := range chains {
		log.Info("Importing preparams into db for chain", chain)

		index := i
		switch cfg.Db.Schema {
		case "dheart1":
			index += len(chains)
		case "dheart2":
			index += 2 * len(chains)
		case "dheart3":
			index += 3 * len(chains)
		}

		preparams := &keygen.LocalPreParams{}
		err := json.Unmarshal([]byte(Preparams[index]), preparams)
		if err != nil {
			panic(err)
		}
		db.SavePreparams(chain, preparams)
	}
}
